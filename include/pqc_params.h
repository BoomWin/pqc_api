#ifndef PQC_PARAMS_H
#define PQC_PARAMS_H

#include <stdint.h>
#include <stddef.h>

// 알고리즘 타입 정의
typedef enum {
    PQC_ALG_ML_KEM, // ML-KEM
    PQC_ALG_ML_DSA, // ML-DSA
    PQC_ALG_SPHINCS // SPHINCS+
} PQC_ALGORITHM;

// 보안 레벨 정의
typedef enum {
    // ML 보안 레벨
    PQC_MODE_1, //  ML-KEM-512, ML-DSA-44,
    PQC_MODE_2, // ML-KEM-768, ML-DSA-65
    PQC_MODE_3, // ML-KEM-1024, ML-DSA-87
    // SPHINCS+ 보안 레벨
    // SHA-2 기반
    PQC_MODE_4, // SPHINCS+-SHA2-128f
    PQC_MODE_5, // SPHINCS+-SHA2-128s
    PQC_MODE_6, // SPHINCS+-SHA2-192f
    PQC_MODE_7, // SPHINCS+-SHA2-192s

    // SHAKE 기반

    // MODE 추가 구현 부분은 여기 정의
} PQC_MODE;


/* Common ML-KEM parameters */
#define MLKEM_N 256
#define MLKEM_Q 3329
#define MLKEM_SYMBYTES 32
#define MLKEM_SSBYTES 32
#define MLKEM_POLYBYTES 384


/*************************************/
/*                                   */
/*  Key Encapsulation Mechanism       */
/*                                   */
/*************************************/

/* KEM Parameters */
// ML-KEM-512
#define MLKEM_512_K 2
#define MLKEM_512_ETA1 3
#define MLKEM_512_POLYCOMPRESSEDBYTES 128
#define MLKEM_512_POLYVECCOMPRESSEDBYTES (MLKEM_512_K * 320) // (2 * 320) // (KYBER_K * 320)

#define MLKEM_512_POLYVECBYTES (MLKEM_512_K * MLKEM_POLYBYTES)

#define MLKEM_512_ETA2 2

#define MLKEM_512_INDCPA_MSGBYTES (MLKEM_SYMBYTES)
#define MLKEM_512_INDCPA_PUBLICKEYBYTES (MLKEM_512_POLYVECBYTES + MLKEM_SYMBYTES)
#define MLKEM_512_INDCPA_SECRETKEYBYTES (MLKEM_512_POLYVECBYTES)
#define MLKEM_512_INDCPA_BYTES (MLKEM_512_POLYCOMPRESSEDBYTES + MLKEM_512_POLYCOMPRESSEDBYTES);

#define ML_KEM_512_PUBLIC_KEY_BYTES  800
#define ML_KEM_512_SECRET_KEY_BYTES  1632
#define ML_KEM_512_CIPHERTEXT_BYTES  768

// ML-KEM-768
#define MLKEM_768_K 3
#define MLKEM_768_ETA1 2
#define MLKEM_768_POLYCOMPRESSEDBYTES 128
#define MLKEM_768_POLYVECCOMPRESSEDBYTES (MLKEM_768_K * 320)

#define MLKEM_768_POLYVECBYTES (MLKEM_768_K * MLKEM_POLYBYTES)

#define MLKEM_768_ETA2 2

#define MLKEM_768_INDCPA_MSGBYTES (MLKEM_SYMBYTES)
#define MLKEM_768_INDCPA_PUBLICKEYBYTES (MLKEM_768_POLYVECBYTES + MLKEM_SYMBYTES)
#define MLKEM_768_INDCPA_SECRETKEYBYTES (MLKEM_768_POLYVECBYTES)
#define MLKEM_768_INDCPA_BYTES (MLKEM_768_POLYVECCOMPRESSEDBYTES + MLKEM_768_POLYCOMPRESSEDBYTES)

#define ML_KEM_768_PUBLIC_KEY_BYTES  1184
#define ML_KEM_768_SECRET_KEY_BYTES  2400
#define ML_KEM_768_CIPHERTEXT_BYTES  1088

// ML-KEM-1024
#define MLKEM_1024_K 4
#define MLKEM_1024_ETA1 2
#define MLKEM_1024_POLYCOMPRESSEDBYTES 128
#define MLKEM_1024_POLYVECBYTES (MLKEM_1024_K * MLKEM_POLYBYTES)

#define MLKEM_1024_POLYVECCOMPRESSEDBYTES (MLKEM_1024_K * 320)

#define MLKEM_1024_ETA2 2

#define MLKEM_1024_INDCPA_MSGBYTES MLKEM_SYMBYTES
#define MLKEM_1024_INDCPA_PUBLICKEYBYTES (MLKEM_1024_POLYVECBYTES + MLKEM_SYMBYTES)
#define MLKEM_1024_INDCPA_SECRETKEYBYTES MLKEM_1024_POLYVECBYTES
#define MLKEM_1024_INDCPA_BYTES (MLKEM_1024_POLYVECCOMPRESSEDBYTES + MLKEM_1024_POLYCOMPRESSEDBYTES)

#define ML_KEM_1024_PUBLIC_KEY_BYTES  1568
#define ML_KEM_1024_SECRET_KEY_BYTES  3168
#define ML_KEM_1024_CIPHERTEXT_BYTES  1568

/* Common derived parameters*/
// Maximum ciphertext size among all ML-KEM modes
#define MLKEM_MAX_CIPHERTEXTBYTES ML_KEM_1024_CIPHERTEXT_BYTES


/*************************************/
/*                                   */
/*  Digital Signature Parameters      */
/*                                   */
/*************************************/

#define MAXLEN 2048  // 최대 메시지 길이

// ML-DSA-44
#define ML_DSA_44_PUBLIC_KEY_BYTES  1312
#define ML_DSA_44_SECRET_KEY_BYTES  2560
#define ML_DSA_44_SIGNATURE_BYTES   2420

// ML-DSA-65
#define ML_DSA_65_PUBLIC_KEY_BYTES  1952
#define ML_DSA_65_SECRET_KEY_BYTES  4032
#define ML_DSA_65_SIGNATURE_BYTES   3309

// ML-DSA-87
#define ML_DSA_87_PUBLIC_KEY_BYTES  2592
#define ML_DSA_87_SECRET_KEY_BYTES  4896
#define ML_DSA_87_SIGNATURE_BYTES   4627

/* SPHINCS+-SHA2-128f-simple */
#define SPHINCS_SHA2_128F_PUBLIC_KEY_BYTES 32
#define SPHINCS_SHA2_128F_SECRET_KEY_BYTES 64
#define SPHINCS_SHA2_128F_SIGNATURE_BYTES 17088

/* SPHINCS+-SHA2-128s-simple */
#define SPHINCS_SHA2_128S_PUBLIC_KEY_BYTES 32
#define SPHINCS_SHA2_128S_SECRET_KEY_BYTES 64
#define SPHINCS_SHA2_128S_SIGNATURE_BYTES 7856

/* SPHINCS+ SHA2-192f-simple */
#define SPHINCS_SHA2_192F_PUBLIC_KEY_BYTES 48
#define SPHINCS_SHA2_192F_SECRET_KEY_BYTES 96
#define SPHINCS_SHA2_192F_SIGNATURE_BYTES 35664

/* SPHINCS+ SHA2-192s-simple */
#define SPHINCS_SHA2_192S_PUBLIC_KEY_BYTES 48
#define SPHINCS_SHA2_192S_SECRET_KEY_BYTES 96
#define SPHINCS_SHA2_192S_SIGNATURE_BYTES 16224


#endif 